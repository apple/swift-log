// Benchmark boilerplate generated by Benchmark

import Benchmark
import Foundation
import Logging

func nothingFunc() {
    // nothing
}

let benchmarks: @Sendable () -> Void = {
    let iterations = 1
    let metrics: [BenchmarkMetric] = [.instructions, .objectAllocCount]

    Benchmark(
        "Nothing benchmark",
        configuration: .init(
            metrics: metrics,
            maxIterations: iterations
        )
    ) { benchmark in
        blackHole(nothingFunc())
    }

    let logLevelParameterization: [Logger.Level] = Logger.Level.allCases
    for logLevel in logLevelParameterization {
        for logLevelUsed in logLevelParameterization {
            Benchmark.defaultConfiguration = .init(
                metrics: metrics,
                tags: [
                    "logLevel": "\(logLevel)",
                    "logLevelUsed": "\(logLevelUsed)",
                ],
                maxIterations: iterations
            )

            var logger = Logger(label: "BenchmarkRunner_\(logLevel)_\(logLevelUsed)")
            logger.logLevel = logLevel

            Benchmark("\(logLevelUsed) instructions count with \(logLevel) log level") { benchmark in
                logger.log(level: logLevelUsed, "hello, benchmarking world")
            }
        }
    }
}
