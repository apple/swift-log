// Benchmark boilerplate generated by Benchmark

import Benchmark
import Foundation
import Logging

func nothingFunc() {
    // nothing
}

let benchmarks: @Sendable () -> Void = {
    let iterations = 1
    let metrics: [BenchmarkMetric] = [.instructions, .objectAllocCount]

    Benchmark(
        "Nothing benchmark",
        configuration: .init(
            metrics: metrics,
            maxIterations: iterations,
            thresholds: [.instructions: .init(absolute: [.p90: 0])],
        )
    ) { benchmark in
        blackHole(nothingFunc())
    }

    let logLevelParameterization: [Logger.Level] = Logger.Level.allCases
    for logLevel in logLevelParameterization {
        for logLevelUsed in logLevelParameterization {
            var logger = Logger(label: "BenchmarkRunner_\(logLevel)_\(logLevelUsed)")
            logger.logLevel = logLevel
            Benchmark(
                "\(logLevelUsed) instructions count with \(logLevel) log level",
                configuration: .init(
                    metrics: metrics,
                    maxIterations: iterations
                )
            ) { benchmark in
                // This is what we actually benchmark
                logger.log(level: logLevelUsed, "hello, benchmarking world")
            }
        }
    }
}
